{"ast":null,"code":"/**\n * Cache Service for API Response Caching\n * Reduces unnecessary network calls and improves UX\n */class CacheService{constructor(){this.cache=new Map();this.pendingRequests=new Map();// Cache duration in milliseconds\nthis.cacheDurations={// User endpoints\n'user/dashboard':30000,// 30 seconds - user balance changes frequently\n'settings/public':300000,// 5 minutes - settings rarely change\n'referrals/stats':60000,// 1 minute\n'tasks/available':30000,// 30 seconds - tasks may update\n'withdrawals/methods':300000,// 5 minutes - methods rarely change\n'withdrawals/history':30000,// 30 seconds\n'faucetpay/info':300000,// 5 minutes\n'earnings/faucet/status':10000,// 10 seconds - status updates frequently\n'ads/providers':300000,// 5 minutes\n'user/earnings':30000,// 30 seconds\n// Admin endpoints\n'admin/dashboard':30000,// 30 seconds - stats update frequently\n'admin/users':15000,// 15 seconds - user list\n'admin/tasks':30000,// 30 seconds - tasks list\n'admin/withdrawals':15000,// 15 seconds - pending withdrawals\n'admin/withdrawal-methods':300000,// 5 minutes\n'admin/settings':60000,// 1 minute - admin settings\n'admin/analytics':60000,// 1 minute - analytics data\n'admin/faucetpay/payments':15000,// 15 seconds - payment history\n'admin/faucetpay/balance':60000,// 1 minute - balance check\n'admin/faucetpay/stats':30000,// 30 seconds - stats\n'default':30000// Default 30 seconds\n};}/**\n   * Generate cache key from URL and params\n   */getCacheKey(url){let params=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(params){const paramString=typeof params==='string'?params:JSON.stringify(params);return\"\".concat(url,\"?\").concat(paramString);}return url;}/**\n   * Get cache duration for a specific endpoint\n   */getCacheDuration(url){// Find matching cache duration\nfor(const[key,duration]of Object.entries(this.cacheDurations)){if(url.includes(key)){return duration;}}return this.cacheDurations.default;}/**\n   * Check if cached data is valid\n   */isValid(cacheEntry){if(!cacheEntry)return false;return Date.now()-cacheEntry.timestamp<cacheEntry.duration;}/**\n   * Get cached data\n   */get(key){const entry=this.cache.get(key);if(this.isValid(entry)){console.log(\"[Cache] HIT: \".concat(key));return entry.data;}if(entry){console.log(\"[Cache] EXPIRED: \".concat(key));this.cache.delete(key);}return null;}/**\n   * Set cached data\n   */set(key,data){let customDuration=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;const duration=customDuration||this.getCacheDuration(key);this.cache.set(key,{data,timestamp:Date.now(),duration});console.log(\"[Cache] SET: \".concat(key,\" (expires in \").concat(duration,\"ms)\"));}/**\n   * Invalidate specific cache entry\n   */invalidate(key){if(this.cache.has(key)){this.cache.delete(key);console.log(\"[Cache] INVALIDATED: \".concat(key));}}/**\n   * Invalidate all cache entries matching a pattern\n   */invalidatePattern(pattern){let count=0;for(const key of this.cache.keys()){if(key.includes(pattern)){this.cache.delete(key);count++;}}if(count>0){console.log(\"[Cache] INVALIDATED \".concat(count,\" entries matching: \").concat(pattern));}}/**\n   * Clear all cache\n   */clear(){this.cache.clear();console.log('[Cache] CLEARED all entries');}/**\n   * Deduplicate concurrent requests for the same resource\n   * Returns existing promise if a request is already in-flight\n   */async deduplicatedFetch(key,fetchFn){// Check cache first\nconst cached=this.get(key);if(cached!==null){return cached;}// Check if there's already a pending request\nif(this.pendingRequests.has(key)){console.log(\"[Cache] DEDUP: Waiting for existing request: \".concat(key));return this.pendingRequests.get(key);}// Create new request promise\nconst requestPromise=(async()=>{try{const data=await fetchFn();this.set(key,data);return data;}finally{this.pendingRequests.delete(key);}})();this.pendingRequests.set(key,requestPromise);return requestPromise;}/**\n   * Get cache stats for debugging\n   */getStats(){return{size:this.cache.size,pendingRequests:this.pendingRequests.size,entries:Array.from(this.cache.keys())};}}// Singleton instance\nconst cacheService=new CacheService();export default cacheService;","map":{"version":3,"names":["CacheService","constructor","cache","Map","pendingRequests","cacheDurations","getCacheKey","url","params","arguments","length","undefined","paramString","JSON","stringify","concat","getCacheDuration","key","duration","Object","entries","includes","default","isValid","cacheEntry","Date","now","timestamp","get","entry","console","log","data","delete","set","customDuration","invalidate","has","invalidatePattern","pattern","count","keys","clear","deduplicatedFetch","fetchFn","cached","requestPromise","getStats","size","Array","from","cacheService"],"sources":["/workspaces/claimpto/frontend/src/services/cacheService.js"],"sourcesContent":["/**\n * Cache Service for API Response Caching\n * Reduces unnecessary network calls and improves UX\n */\n\nclass CacheService {\n  constructor() {\n    this.cache = new Map();\n    this.pendingRequests = new Map();\n    \n    // Cache duration in milliseconds\n    this.cacheDurations = {\n      // User endpoints\n      'user/dashboard': 30000,       // 30 seconds - user balance changes frequently\n      'settings/public': 300000,     // 5 minutes - settings rarely change\n      'referrals/stats': 60000,      // 1 minute\n      'tasks/available': 30000,      // 30 seconds - tasks may update\n      'withdrawals/methods': 300000, // 5 minutes - methods rarely change\n      'withdrawals/history': 30000,  // 30 seconds\n      'faucetpay/info': 300000,      // 5 minutes\n      'earnings/faucet/status': 10000, // 10 seconds - status updates frequently\n      'ads/providers': 300000,       // 5 minutes\n      'user/earnings': 30000,        // 30 seconds\n      \n      // Admin endpoints\n      'admin/dashboard': 30000,      // 30 seconds - stats update frequently\n      'admin/users': 15000,          // 15 seconds - user list\n      'admin/tasks': 30000,          // 30 seconds - tasks list\n      'admin/withdrawals': 15000,    // 15 seconds - pending withdrawals\n      'admin/withdrawal-methods': 300000, // 5 minutes\n      'admin/settings': 60000,       // 1 minute - admin settings\n      'admin/analytics': 60000,      // 1 minute - analytics data\n      'admin/faucetpay/payments': 15000, // 15 seconds - payment history\n      'admin/faucetpay/balance': 60000,  // 1 minute - balance check\n      'admin/faucetpay/stats': 30000,    // 30 seconds - stats\n      \n      'default': 30000               // Default 30 seconds\n    };\n  }\n\n  /**\n   * Generate cache key from URL and params\n   */\n  getCacheKey(url, params = null) {\n    if (params) {\n      const paramString = typeof params === 'string' ? params : JSON.stringify(params);\n      return `${url}?${paramString}`;\n    }\n    return url;\n  }\n\n  /**\n   * Get cache duration for a specific endpoint\n   */\n  getCacheDuration(url) {\n    // Find matching cache duration\n    for (const [key, duration] of Object.entries(this.cacheDurations)) {\n      if (url.includes(key)) {\n        return duration;\n      }\n    }\n    return this.cacheDurations.default;\n  }\n\n  /**\n   * Check if cached data is valid\n   */\n  isValid(cacheEntry) {\n    if (!cacheEntry) return false;\n    return Date.now() - cacheEntry.timestamp < cacheEntry.duration;\n  }\n\n  /**\n   * Get cached data\n   */\n  get(key) {\n    const entry = this.cache.get(key);\n    if (this.isValid(entry)) {\n      console.log(`[Cache] HIT: ${key}`);\n      return entry.data;\n    }\n    if (entry) {\n      console.log(`[Cache] EXPIRED: ${key}`);\n      this.cache.delete(key);\n    }\n    return null;\n  }\n\n  /**\n   * Set cached data\n   */\n  set(key, data, customDuration = null) {\n    const duration = customDuration || this.getCacheDuration(key);\n    this.cache.set(key, {\n      data,\n      timestamp: Date.now(),\n      duration\n    });\n    console.log(`[Cache] SET: ${key} (expires in ${duration}ms)`);\n  }\n\n  /**\n   * Invalidate specific cache entry\n   */\n  invalidate(key) {\n    if (this.cache.has(key)) {\n      this.cache.delete(key);\n      console.log(`[Cache] INVALIDATED: ${key}`);\n    }\n  }\n\n  /**\n   * Invalidate all cache entries matching a pattern\n   */\n  invalidatePattern(pattern) {\n    let count = 0;\n    for (const key of this.cache.keys()) {\n      if (key.includes(pattern)) {\n        this.cache.delete(key);\n        count++;\n      }\n    }\n    if (count > 0) {\n      console.log(`[Cache] INVALIDATED ${count} entries matching: ${pattern}`);\n    }\n  }\n\n  /**\n   * Clear all cache\n   */\n  clear() {\n    this.cache.clear();\n    console.log('[Cache] CLEARED all entries');\n  }\n\n  /**\n   * Deduplicate concurrent requests for the same resource\n   * Returns existing promise if a request is already in-flight\n   */\n  async deduplicatedFetch(key, fetchFn) {\n    // Check cache first\n    const cached = this.get(key);\n    if (cached !== null) {\n      return cached;\n    }\n\n    // Check if there's already a pending request\n    if (this.pendingRequests.has(key)) {\n      console.log(`[Cache] DEDUP: Waiting for existing request: ${key}`);\n      return this.pendingRequests.get(key);\n    }\n\n    // Create new request promise\n    const requestPromise = (async () => {\n      try {\n        const data = await fetchFn();\n        this.set(key, data);\n        return data;\n      } finally {\n        this.pendingRequests.delete(key);\n      }\n    })();\n\n    this.pendingRequests.set(key, requestPromise);\n    return requestPromise;\n  }\n\n  /**\n   * Get cache stats for debugging\n   */\n  getStats() {\n    return {\n      size: this.cache.size,\n      pendingRequests: this.pendingRequests.size,\n      entries: Array.from(this.cache.keys())\n    };\n  }\n}\n\n// Singleton instance\nconst cacheService = new CacheService();\n\nexport default cacheService;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}